# Ubuntu-Mini-Respin

This is an attempt to recreate Minibuntu/Ubuntu Mini Remix.

Ubuntu Mini Remix (previously Miniubuntu) was a fully working Ubuntu LiveCD containing only the minimal set of software to make the system work. It was under development between 2010 and 2017 by [Fabrizio Balliano](https://github.com/fballiano). The ISO image was about 200 MB in size.

It enabled you to build your own Ubuntu based LiveCD using Ubuntu Customization Kit, Reconstructor or any other tool to remaster the ISO and add the software/configurations you wanted, building your own Ubuntu based LiveCD.

The script creates an Ubuntu ISO with as few dependencies as possible to be used as a base for respins.

## How Close Is It To Ubuntu Mini Remix?

Not close enough! _This is a work in progress to reduce the differences._

The process to create the Ubuntu Mini Remix doesn't appear to have be documented or is just no longer available.

See [here](https://answers.launchpad.net/ubuntu-mini-remix/+faq/33) for packages bundled in Ubuntu Mini Remix

> Ubuntu Mini Remix contains:
> - ubuntu-minimal (this is a metapackage, details at [http://tinyurl.com/2cpw6o])
> - ubuntu-standard (this is a metapackage, details at [http://tinyurl.com/323nu8])
> - casper
> - lupin-casper

The last published version of Ubuntu Mini Remix was based on 16.04 (xenial) so the first step is to try to reproduce the filesystem as closely as possible.

The following will list the contents of the filesystem on iso.
We exclude the dates to make the comparison easier.

    sudo mkdir /mnt/remix
    sudo mount -o loop ubuntu-mini-remix-16.04-amd64.iso /mnt/remix 
    sudo unsquashfs /mnt/remix/casper/filesystem.squashfs
    cd squashfs-root
    sudo find -printf "%P \t %u \t %g %m (%M) \t %k \n" > ../xenial-remix.txt
    sudo umount /mnt/remix
    cd ..
    sudo rm -rf squashfs-root

Similarly, the following will list the contents of the filesystem generated by this project.
We can then diff the two to see how close it is to the original.

    cd build/xenial
    sudo find -printf "%P \t %u \t %g %m (%M) \t %k \n" | sed "s/$(whoami)/root/g"> ../../xenial-respin.txt

These outputs are checked in to make it easy to see what the differences are without requiring a build.

## Instructions

There are two sub-directories with different ways of creating the ISO.

The first uses `debootstrap` and does all the work from scratch in a similar way to the [wiki](https://help.ubuntu.com/community/LiveCDCustomizationFromScratch).

The second one uses `ubuntu-defaults-builder` in the same way that the original Ubuntu Mini Remix was created.

Since you are likely to want to run this multiple times, the script makes use of `squid` as a proxy to cache the deb files and the repository Release files. 
This is more reliable for offline work than `apt-cacherng` as squid can cache more than just the deb files.

The squid config is copied from `squid-deb-proxy` and has been modified slightly to run local to the project (instead of saving the cache/logs in the system dirs) and has been tweaked to work completely offline.

**Install squid**

    sudo apt install squid

**Start squid with the local config**

    ./caching-proxy.sh

**Run the main script**

    ./ubuntu-mini-respin.sh
 
## Tip and Guides

See here for tips on reducing debian size

https://wiki.debian.org/ReduceDebian


Guides on customising the Ubuntu LiveCD 

* https://help.ubuntu.com/community/LiveCDCustomization
* https://nathanpfry.com/how-to-customize-an-ubuntu-installation-disc/

Another script wrapping the above guide

https://pastebin.com/NQUTWC1y
